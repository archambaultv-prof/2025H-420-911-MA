---
sidebar_position: 1
sidebar_label: PowerShell et manipulation de fichiers
description: PowerShell et manipulation de fichiers
---


# ğŸ—ƒï¸ PowerShell et manipulation de fichiers

- Seul, Ã  votre rythme

## ğŸ¯ Objectif pÃ©dagogique

* Manipuler des fichiers et rÃ©pertoires via PowerShell
* Automatiser des tÃ¢ches simples avec des scripts
* Utiliser les chemins relatifs et absolus
* Rechercher des fichiers et du contenu textuel dans une arborescence
* Afficher et modifier les permissions des fichiers

## ğŸ“œ Ã‰noncÃ©

### ğŸ”§ Contexte

Un administrateur systÃ¨me vous confie une sÃ©rie de tÃ¢ches Ã  rÃ©aliser via
PowerShell. Ces tÃ¢ches pourraient Ãªtre automatisÃ©es dans un petit script. Vous
devez crÃ©er un environnement de travail, manipuler des fichiers et rÃ©pertoires,
le tout en utilisant PowerShell.

## ğŸ“ Ã‰tape 1 â€“ PrÃ©parer un environnement

1. Ouvrez PowerShell dans un dossier de travail de votre choix.
2. CrÃ©ez la structure suivante avec PowerShell :

```
projet/
â”œâ”€â”€ notes/
â”œâ”€â”€ archives/
â””â”€â”€ temp/
```

3. Dans le dossier `notes`, crÃ©ez 3 fichiers texte nommÃ©s `cours1.txt`, `cours2.txt`, `cours3.txt`.
   Chacun de ces fichiers doit contenir une phrase diffÃ©rente, incluant le mot **important** dans lâ€™un dâ€™eux.
   InsÃ©rez le contenu directement dans les fichiers avec PowerShell.
4. Dans le dossier `temp`, crÃ©ez un fichier texte nommÃ© `temp.txt` avec le contenu suivant :
   ```
   Ce fichier est temporaire.
   ```

Commandes utiles : 
* `New-Item` pour crÃ©er des fichiers et des dossiers
* `Set-Content` pour Ã©crire du contenu dans les fichiers
* `Get-ChildItem` pour lister les fichiers et dossiers

## ğŸ“‚ Ã‰tape 2 â€“ Recherches et chemins

1. Recherchez tous les fichiers `.txt` dans le dossier `projet`, **mÃªme dans les sous-dossiers**.
2. Recherchez le mot `important` dans **tous** les fichiers texte.
3. Affichez le chemin absolu de chacun des fichiers `.txt`.

Commandes utiles :
* `Get-ChildItem -Recurse` pour lister les fichiers rÃ©cursivement
* `Select-String` pour rechercher du texte dans les fichiers
* `Resolve-Path` pour obtenir le chemin absolu des fichiers


## ğŸ”„ Ã‰tape 3 â€“ Automatisation et englobement simple

1. Ã‰crivez un script PowerShell nommÃ© `gestion.ps1` qui fait les opÃ©rations suivantes :

   * Copie tous les fichiers de `notes` vers `archives`
   * Supprime le contenu du dossier `temp` sâ€™il existe (sans supprimer `temp` lui-mÃªme)
   * Renomme les fichiers copiÃ©s dans `archives` en ajoutant `_backup` avant `.txt`

     * Exemple : `cours1.txt` â†’ `cours1_backup.txt`

Commandes utiles :
* `Test-Path` pour vÃ©rifier lâ€™existence dâ€™un dossier ou dâ€™un fichier
* `Copy-Item` pour copier des fichiers
* `Remove-Item` pour supprimer des fichiers ou dossiers
* `Rename-Item` pour renommer des fichiers


ExÃ©cutez plusieurs fois votre script pour vÃ©rifier quâ€™il est idempotent (ne casse rien sâ€™il est relancÃ© plusieurs fois).


## ğŸ§ª Ã‰tape 4 â€“ VÃ©rification automatique

Ajoutez Ã  votre script une commande qui :

* Compte et affiche le nombre de fichiers dans `archives`
* Affiche un message **"SuccÃ¨s : tous les fichiers ont Ã©tÃ© sauvegardÃ©s."** si ce nombre est 3


## ğŸ” Ã‰tape 5 â€“ Permissions NTFS (droits dâ€™accÃ¨s)

1. Dans le dossier `notes/`, enlevez Ã  lâ€™utilisateur courant **le droit de
   lecture** sur un des fichiers. Ceci doit Ãªtre fait en utilisant PowerShell.

2. Essayez de lire ce fichier avec `Get-Content`. Que se passe-t-il ?

3. RÃ©tablissez ensuite la permission avec PowerShell.

4. Donnez temporairement Ã  **tout le dossier `archives/`** une permission en lecture-Ã©criture seulement (pas suppression).

5. Tentez ensuite dâ€™effacer un fichier de `archives/` avec `Remove-Item`. Que constatez-vous ?
